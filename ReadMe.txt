Code currently not working, ran into stragne compilation error. Must have more time to fix.